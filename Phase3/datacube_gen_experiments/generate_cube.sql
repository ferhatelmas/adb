create table cube_prod_lzoom_time
SELECT NULL AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT
UNION
SELECT NULL AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, TIME
UNION
SELECT REGIONKEY AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION
UNION
SELECT REGIONKEY AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT NATIONKEY AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION
UNION
SELECT NATIONKEY AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME;

create view prod_cube AS 
SELECT NULL AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT
UNION
SELECT NULL AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, TIME
UNION
SELECT NULL AS LOCATION, YEARMONTH AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, TIME
UNION
SELECT NULL AS LOCATION, DAY_OF_YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, TIME
UNION
SELECT REGIONKEY AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION
UNION
SELECT REGIONKEY AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT REGIONKEY AS LOCATION, YEARMONTH AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT REGIONKEY AS LOCATION, DAY_OF_YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT NATIONKEY AS LOCATION, NULL AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION
UNION
SELECT NATIONKEY AS LOCATION, YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT NATIONKEY AS LOCATION, YEARMONTH AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME
UNION
SELECT NATIONKEY AS LOCATION, DAY_OF_YEAR AS TIME, PRODUCT_ID AS PRODUCT, P_NAME AS PRODUCT_NAME,  SUM(VOLUME) AS SUM_VOLUME, AVG(VOLUME) AS AVG_VOLUME FROM fulljoin  GROUP BY PRODUCT, LOCATION, TIME;

